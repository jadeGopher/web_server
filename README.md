#Веб-сервер для социальной сети meet&go
Основные параметры указаны в конфигурационном файле (config.json).

    {
    "dataBase": {               //Настройки базы данных
        "username": "postgres", //Имя пользователя
        "password": "password", //Пароль
        "dbName": "name",       //Название базы данных
        "ip": "127.0.0.1",      //IP адрес базы данных
        "port": 5432,           //Порт для подключения
        "reInitDataBase": false //Указать true для переинициализации базы данных
    },
    "log": true                 //Включить режим логирования 
    "staticDir": "/build/",     //Указание директории для static объектов
      "cert": {
        "certFilePath": "realcert/fullchain1.pem", //Путь до файла сертификата
        "keyFilePath": "realcert/privkey1.pem"     //Путь до ключа
      }
    }

Стоит учесть, что данный сервер работет только с базой данных PostgreSQL.

При указании парамемтра __reInitDataBase__ в конфигурационном файле удаляются все существующие таблицы со всеми данными
и пересоздаются (предполагалось, что его стоит использовать для инициализации таблиц в базе данных)

При указании параметра __log__ в конфигурационном файле веб-сервер будет осуществлять журналирование запросов 
в таблицу log в развернутой базе данных.

## Запросы

На данный момент реализованы следующие запросы:

`hostname/registration "POST"` - запрос на регистрацию

`hostname/login "POST"` - запрос на авторизацию

`hostname/profiles/{id} "GET"` - запрос на получение информации о профиле

`hostname/search "GET"` - запрос на поиск пользователей

`hostname/delete "POST"` - запрос на удаление аккаунта

`hostname/tags "GET"` - запрос на получение всех тэгов

`hostname/tags/add "POST"` - запрос на добавление себе тэгов

`hostname/tags/get/{id} "GET"` - запрос на получение тэгов пользователя

`hostname/tasks "GET"` - запрос на получение информации о задании

`hostname/tasks/tags "GET"` - запрос на получение тэгов задания

`/invite/user/{id} "POST"` - запрос на приглашение пользователя

`/invite/show "GET"` - запрос на демонстрацию приглашений

`/validate/show "GET"` - запрос на получение тех зааний, которые требуется подтвердить 

`/quests/show "GET"` - запрос на получение своих заданий

`/quest/status/change "POST"` - запрос на изменинение статуса задания

А так же несколько запросов для разработчиков:

`hostname/developers/getAccount "GET"` - запрос на получение аккаунта разработчика 

`hostname/developers/postTag "POST"` - запрос на добавление тэга

`/developers/tasks/post "POST"` - запрос на публикацию задания

`/developers/tasks/addTags "POST"` - запрос на добавление тэгов к заданию

### Формат ответов
В слуаче успешного ответа, клиенту будет предоставлен ответ в формате json следующего содержания:

    {"element":какой-либо ответ}

В случае неудачного ответе, клиенту будет предоставлен ответ а формате json следующего содержания:
    
    {"error":{"code":101,"message":"'userIdField' not unique"}}
 
Также дополнительно статус запроса будет иметь код 400.

### hostname/registration "POST"
Для данного запроса требуется прикрепить тело следующего формата:

     {
        "userPrivate": {
            "email": "pug_brown@email.com", //почта
            "userId": "brownPug",           //никнейм пользователя
            "password": "myPass"            //пароль
        },
        "userInfo": {  
            "firstName": "Pug",             //Имя
            "lastName": "Purple",           //Фамилия
            "private": 0,                   //приватный аккаунт или нет (если не уставнолено, то не приватный)
            "picture": "no_pic",            //ссылка на фото профиля
            "backgroundPicture": "no_pic",  //ссылка на задний фон профиля
            "gender": "male"                //пол можеть быть male, female, another
        }
     }

После отправки запроса пользователь получит ответ, в котором будет ошибка или же успешный ответ:

    {"element":"success"}

Также пользователю прийдут в ответ два заголовка: `Session_id` и `User_id` в которых будут содержаться данные 
для аутентификаии клиента

### hostname/login "POST"

Для авторизации клиента требуется отправить запрос на указанаый путь со следующим телом:

    {
      "identity": "brownPug",
      "password": "myPass"
    }
    
Если в базе данных будет содержаться пользователь с такими аутентификационными данными, то клиент получит ответ 

    {"element":"success"}

Так же, как и в предыдущем запросе, клиент в ответе сможет обнаружить два заголовка: `Session_id` и `User_id`.
Данные заголовки требуются для произведения запросов для которы требуется аутентификация.


### hostname/profiles/{id} "GET"

Данный запрос используется для получения информации о конкретном пользователе.
В пути следует указать никнейм пользователя.

Данный запрос требует аутентификации, поэтому требуется указать в заголовках заголовки,
полученные из запроса на регистрацию или же авотризацию.
Если пользователь зарегистрирован в системе, но имеет приватный профиль (private=1 в user_info), то при запросе 
информации о его профиле, сервер вернет ошибку.

При успешном выполнении запроса клиенту вернется ответ в json формате вида:

    {
      "element": {
        "userId": "blackPug",
        "firstName": "Pug",
        "lastName": "White",
        "regTime": "2020-05-30T21:43:40+03:00",
        "private": 0,
        "picture": "no_pic",
        "backgroundPicture": "no_pic",
        "gender": "male",
        "onlineTime": "0001-01-01T00:00:00Z"
      }
    }

### hostname/search "GET"

Запрос на поиск произвольных пользователей также треубет заголовки `Session_id` и `User_id`.

Для данного запроса требуется указать три аргумента в query зарпоса:

query - строка поиска;

count - число возвращаемых исомых пользователей;

from - с какой записи в базе данных стоит возвращать число найденных пользователей.

Производится проверка содержания данной подстроки в строках с именем, фамилией и никнеймом
пользователя. Если с начала одной из этих строк содержиться искомая подстрока, то такой пользователь 
вернется в ответе.

Пользователи, которые имеют приватный аккаунт не будут возвращены в ответе на данный запрос.

Также при помощи данного запроса нельзя найти себя самого.

При успешном выполнении такого запроса, вернется следующий ответ:

    {
      "element": [
        {
          "userId": "brownPug",
          "firstName": "Pug",
          "lastName": "Purple",
          "regTime": "2020-06-10T03:45:17+03:00",
          "private": 0,
          "picture": "no_pic",
          "backgroundPicture": "no_pic",
          "gender": "male",
          "onlineTime": "0001-01-01T00:00:00Z"
        }
      ]
    }

### hostname/delete "POST"

Запрос на удаление своего аккаунта.
Для выполнения данного запроса требуется указать заголовки `Session_id` и `User_id`.

Также требуется указать свои логин и пароль в теле запроса.

    {
      "identity": "oreoPug",
      "password": "myPass"
    }

При успешном выполнении такого запроса вернется следующий ответ:

{"element":"success"}

Все данные, связанные с удаленным аккаунтом автоматически удаляются из базы данных.

### hostname/tags "GET"

Запрос на полуение всех имеющихся тэгов.
Для выполнения данного запроса требуется указать заголовки `Session_id` и `User_id`.

Для данного запроса требуется указать два аргумента в query зарпоса:

count - число возвращаемых тэгов;

from - с какой записи в базе данных стоит возвращать указанное число тэгов.

При успешном выполнении запроса будет получен следующий ответ:

    {
      "element": [
        {
          "name": "кино",
          "description": "для любителей кино"
        },
        {
          "name": "короткие",
          "description": "короткие задачи"
        }
      ]
    }

### hostname/tags/add "POST"

Запрос на добавление своему аккаунту тэгов.
Для выполнения данного запроса требуется указать заголовки `Session_id` и `User_id`.

В теле запроса следует указать массив объектов, который содержит имя добавляемых тэгов.

    [
      {
        "name": "кино"
      },
      {
        "name": "короткие"
      }
    ]

Очевидно, что данные тэги должны сущестовать в без данных, иначе сервер вернет ошибку.
После отправки данного запроса сервер смотрит на отправленные тэги и на тэги пользователя, которые уже 
сожеражтся в базе данных для данного пользователя. 

Если указанный тэг в запросе существует, то рейтинг данного тэга не будет изменен;

Если указанный тэг в запросе не существует, то польлзователю добавляется новый тэг;

Если тэг, содержащийся в базе данных не указан в запросе, то он удалится.

При успешном выолнении данного запроса клиент получит следующий ответ:

    {"element":"success"}


### hostname/tags/get/{id} "GET"

Запрос на полуение тэгов указанного пользователя.

Для выполнения данного запроса требуется указать заголовки `Session_id` и `User_id`.

Данный запрос работает по такой же схеме, как и запрос на получение информации о пользоватле, но 
возвращает тэги указанного пользователя.

При успешном выполнении данного запроса клиент получит следующий ответ:

    {
      "element": [
        {
          "id": "blackPug",
          "tagName": "кино",
          "rating": 5
        },
        {
          "id": "blackPug",
          "tagName": "короткие",
          "rating": 5
        }
      ]
    }

### hostname/tasks "GET"

Запрос на получения информации о задании.

Для выполнения данного запроса требуется указать заголовки `Session_id` и `User_id`.

В query требуется указать параметр `task` и указать название задания

В случае указания правильного названия названия вернется следующая структура:

    {
      "element": {
        "name": "test_task",
        "picture": "no_pic",
        "backgroundPicture": "no_pic",
        "description": "test_description",
        "recommendedTime": "Mon, 01 Jan 0001 00:00:00 UTC"
      }
    }

### hostname/tasks/tags "GET"

Запрос на получение тэгов задания.

Для выполнения данного запроса требуется указать заголовки `Session_id` и `User_id`.

В query требуется указать параметр `task` и указать название задания

При указании имени задания,  которое содержится в базе данных клиент получит следующий ответ:

    {
      "element": [
        {
          "id": "test_task",
          "tagName": "кино",
          "rating": 5
        },
        {
          "id": "test_task",
          "tagName": "короткие",
          "rating": 5
        }
      ]
    }

### hostname/invite/user/{id} "POST"

Запрос на приглашение пользователя.

Для выполнения данного запроса требуется указать заголовки `Session_id` и `User_id`.

В пути требуется указать никнейм пользователя, которого клиент хочет пригласить. 

Нельзя пригласить пользователей, которые имеют приватный аккаунт.

В случае успешного выполнения запроса клиент получит ответ:

     {"element":"success"}

### hostname/invite/show "GET"

Для выполнения данного запроса требуется указать заголовки `Session_id` и `User_id`.

Данный запрос треубется для того, чтобы пользователь мог просмотреть задания, в которые его пригласили.
При успешной аутентификации клиент получит ответ в следующем формате:

    {
      "element": [
        {
          "questId": 9,
          "userId": "orangePug",
          "taskName": "",
          "userOpponent": "blackPug",
          "status": 0,
          "startTime": "",
          "endTime": "",
          "deadlineTime": ""
        }
      ]
    }

### hostname/validate/show "GET" 

Для выполнения данного запроса требуется указать заголовки `Session_id` и `User_id`.

Данный запрос треубется для того, чтобы получить список заданий, которые требуется подтвердить пользователю.

Работает также как и запрос на получение заданий в которые пригласили клиента т.е. предыдущий.

Ответ приходит точно в таком де формате.

### hostname/quests/show "GET"

Для выполнения данного запроса требуется указать заголовки `Session_id` и `User_id`.

Для данного запроса требуется указать в query параметр status (=0, 1, 2, 3, 4, 5, 6, 7, 8, all)

Запрос на получение своих заданий по категории. Можно выбрать задания по одной из 9 категорий или же
получить сразу все категории, указав all.

При успещном выполнении данного запроса клиент получит ответ в следующем формате:

    {
      "element": [
        {
          "questId": 3,
          "userId": "blackPug",
          "taskName": "super_short_task",
          "userOpponent": "orangePug",
          "status": 6,
          "startTime": "Mon, 01 Jun 2020 03:33:24 MSK",
          "endTime": "Mon, 01 Jun 2020 03:33:40 MSK",
          "deadlineTime": "Mon, 01 Jun 2020 03:34:24 MSK"
        },
        {
          "questId": 8,
          "userId": "blackPug",
          "taskName": "",
          "userOpponent": "orangePug",
          "status": 2,
          "startTime": "",
          "endTime": "",
          "deadlineTime": ""
        }
      ]
    }

### hostname/quest/status/change "POST"

Для выполнения данного запроса требуется указать заголовки `Session_id` и `User_id`.

Так же в теле запроса требуется указать информацию  о том, в каком задании клиент изменяет статус, 
а также какой статус требуется поставить.

    {
        "questId": 7,
        "status": 4
    }
    
Клиент может изменять статус своих задач, а также задач в которых он участвует. 

Клиент может изменить статус задания на следующие статусы:

Rejected;
		
NotSelected;
		
Started;
	
Waiting;
		
Accepted;
		
NotAccepted.

При смены статуса задания на Started, сервер выбирает случайное задание и вставляет в соответсвующий квест.

При этом нельзя изменить произвольный статус на статус, указанный выше.
		